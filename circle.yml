machine:
    environment:
        ANDROID_API_LEVEL: 25
        ANDROID_BUILD_TOOLS_VERSION: 25.0.3
    java:
        version: oraclejdk8
    timezone:
        America/Montreal

checkout:
  post:
    - git submodule update --init --recursive commons
    - git submodule update --init --recursive commons-android
    - git submodule update --init --recursive parser
    - git submodule update --init --recursive agency-parser
    - git submodule update --init --recursive app-android
    - chmod +x gradlew

test:
  post:
    - ./build.sh

dependencies:
    override:
        - echo y | android update sdk --no-ui --all --filter "tools" # to get the new `repository.xml`
        - echo y | android update sdk --no-ui --all --filter "platform-tools"
        - echo y | android update sdk --no-ui --all --filter "tools" # to install Android SDK tools
        - echo y | android update sdk --no-ui --all --filter "build-tools-$ANDROID_BUILD_TOOLS_VERSION"
        - echo y | android update sdk --no-ui --all --filter "android-$ANDROID_API_LEVEL"
        - echo y | android update sdk --no-ui --all --filter "addon-google_apis-google-$ANDROID_API_LEVEL"
        - echo y | android update sdk --no-ui --all --filter "extra-google-google_play_services"
        - echo y | android update sdk --no-ui --all --filter "extra-android-support"
        - echo y | android update sdk --no-ui --all --filter "extra-google-m2repository"
        - echo y | android update sdk --no-ui --all --filter "extra-android-m2repository"
